<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sadao Queue V18 (Space & Senior Friendly)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;800&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CORE THEME --- */
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #0b1021; /* Deep Space */
            color: #e2e8f0;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 3px),
                radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 2px),
                radial-gradient(white, rgba(255,255,255,.1) 2px, transparent 3px);
            background-size: 550px 550px, 350px 350px, 250px 250px;
            background-position: 0 0, 40px 60px, 130px 270px;
            animation: starMove 120s linear infinite;
        }

        @keyframes starMove {
            from { background-position: 0 0, 40px 60px, 130px 270px; }
            to { background-position: 550px 550px, 390px 410px, 680px 820px; }
        }

        /* --- HEADERS --- */
        .time-header {
            font-family: 'Rajdhani', sans-serif;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-left: 6px solid #22d3ee; /* Neon Cyan */
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.2);
            color: #fff;
            padding: 10px 20px;
            font-size: 1.8rem; /* ‡πÉ‡∏´‡∏ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏© */
            font-weight: 700;
            border-radius: 12px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: 1px;
        }

        /* --- CARD DESIGN --- */
        .queue-card {
            border-radius: 16px;
            padding: 16px;
            position: relative;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        /* Effect: Scanline (‡πÄ‡∏™‡πâ‡∏ô‡∏™‡πÅ‡∏Å‡∏ô‡∏ß‡∏¥‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏ö‡∏≤‡πÜ ‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÑ‡∏Æ‡πÄ‡∏ó‡∏Ñ) */
        .queue-card::after {
            content: "";
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.05), transparent);
            transform: rotate(45deg);
            animation: scan 4s infinite linear;
            pointer-events: none;
        }
        @keyframes scan { 0% {top: -50%;} 100% {top: 150%;} }

        /* --- COLOR LOGIC THEMES (High Contrast for Seniors) --- */
        
        /* 1. ‡∏õ‡∏Å‡∏ï‡∏¥ (Dark Theme) */
        .theme-normal {
            background: rgba(30, 41, 59, 0.7); /* Glass Dark */
            backdrop-filter: blur(12px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            border-left: 6px solid #94a3b8;
        }

        /* 2. ‡∏ß‡πà‡∏≤‡∏á (Free) */
        .theme-free {
            background: rgba(6, 78, 59, 0.4);
            border: 1px solid #10b981;
            border-left: 6px solid #10b981;
            color: #d1fae5;
        }

        /* 3. ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (Cancel) */
        .theme-cancel {
            background: #334155;
            color: #94a3b8;
            border-left: 6px solid #64748b;
            opacity: 0.8;
        }

        /* --- ‡∏™‡∏µ‡∏ï‡∏≤‡∏° Google Sheet (‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡πÜ) --- */
        
        /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß) -> ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏î‡∏≥‡πÄ‡∏Ç‡πâ‡∏° */
        .theme-sheet-green {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #022c22; /* ‡∏î‡∏≥‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
            border: 2px solid #86efac;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.4);
        }

        /* ‡∏ä‡∏°‡∏û‡∏π (‡πÇ‡∏ó‡∏£‡πÅ‡∏à‡πâ‡∏á) -> ‡∏û‡∏∑‡πâ‡∏ô‡∏ä‡∏°‡∏û‡∏π‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏î‡∏≥‡∏°‡πà‡∏ß‡∏á */
        .theme-sheet-pink {
            background: linear-gradient(135deg, #f472b6 0%, #e879f9 100%);
            color: #4a044e; /* ‡∏î‡∏≥‡∏°‡πà‡∏ß‡∏á */
            border: 2px solid #fbcfe8;
        }

        /* ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á (‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) -> ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏î‡∏≥‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• */
        .theme-sheet-yellow {
            background: linear-gradient(135deg, #facc15 0%, #eab308 100%);
            color: #422006; /* ‡∏î‡∏≥‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• */
            border: 2px solid #fde047;
        }

        /* --- TYPOGRAPHY (Big & Clear) --- */
        .staff-name {
            font-size: 1.5rem; /* ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏≠‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
            font-weight: 800;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 8px;
        }

        .patient-name-container {
            height: 60px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ä‡∏∑‡πà‡∏≠ */
            display: flex;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1); /* ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏à‡∏≤‡∏á‡πÜ */
            margin-bottom: 8px;
        }
        /* ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏™‡∏µ‡∏™‡∏î ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô */
        .theme-sheet-green .patient-name-container,
        .theme-sheet-pink .patient-name-container,
        .theme-sheet-yellow .patient-name-container {
            border-color: rgba(0,0,0,0.1);
        }

        .patient-text {
            font-size: 1.4rem; /* ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∞‡πÉ‡∏à */
            font-weight: 700;
            line-height: 1.1;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* --- BADGES & DETAILS --- */
        .detail-row {
            font-size: 1.1rem; /* ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà */
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        /* ‡∏õ‡πâ‡∏≤‡∏¢‡∏¢‡∏≤ (Treatment Badge) */
        .badge-treatment {
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 600;
            display: inline-block;
        }
        /* ‡∏™‡∏µ‡∏õ‡πâ‡∏≤‡∏¢‡∏¢‡∏≤‡πÅ‡∏ö‡∏ö Tech */
        .theme-normal .badge-treatment { background: rgba(6, 182, 212, 0.2); border: 1px solid #06b6d4; color: #67e8f9; }
        
        /* ‡∏™‡∏µ‡∏õ‡πâ‡∏≤‡∏¢‡∏¢‡∏≤‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏™‡∏µ‡∏™‡∏î (‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß‡∏à‡∏≤‡∏á‡πÜ ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å) */
        .theme-sheet-green .badge-treatment,
        .theme-sheet-pink .badge-treatment,
        .theme-sheet-yellow .badge-treatment {
            background: rgba(255,255,255,0.4);
            border: 1px solid rgba(0,0,0,0.1);
            color: #000;
            font-weight: 700;
        }

        /* ‡∏à‡∏≠‡∏á */
        .badge-booking {
            background: #ea580c; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.9rem; margin-right: 5px; box-shadow: 0 0 5px #ea580c;
        }

        /* ‡∏Ñ‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (Strike) */
        .strike-text {
            color: #ef4444; /* ‡πÅ‡∏î‡∏á‡∏™‡∏î */
            text-decoration: line-through;
            font-weight: 700;
            background: rgba(0,0,0,0.3);
            padding: 2px 6px;
            border-radius: 4px;
        }
        /* ‡∏Ñ‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏™‡∏µ‡∏™‡∏î */
        .theme-sheet-yellow .strike-text, .theme-sheet-green .strike-text {
            color: #b91c1c; /* ‡πÅ‡∏î‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏°‡∏π */
            background: rgba(255,255,255,0.3);
        }

        /* ‡πÄ‡∏•‡∏Ç‡∏´‡πâ‡∏≠‡∏á */
        .room-tag {
            font-family: 'Rajdhani', sans-serif;
            background: #000;
            color: #facc15; /* ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ó‡∏≠‡∏á */
            border: 1px solid #ca8a04;
            padding: 2px 10px;
            border-radius: 6px;
            font-size: 1.2rem;
            font-weight: 700;
            box-shadow: 0 0 10px rgba(250, 204, 21, 0.3);
        }

        /* Loading */
        .spin-slow { animation: spin 2s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="pb-24">

    <header class="bg-slate-900/90 backdrop-blur-lg border-b border-cyan-500/30 sticky top-0 z-50 shadow-[0_0_20px_rgba(6,182,212,0.2)]">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center max-w-6xl">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-600 to-blue-800 flex items-center justify-center text-white shadow-lg border border-cyan-400">
                    <i class="fas fa-user-md text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-white tracking-wider" style="text-shadow: 0 0 10px rgba(34,211,238,0.5);">‡∏Ñ‡∏¥‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢</h1>
                    <div class="flex items-center gap-2 text-cyan-400 text-sm font-mono">
                        <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                        <span id="lastUpdate">INITIALIZING...</span>
                    </div>
                </div>
            </div>
            <button onclick="fetchData(false)" class="w-12 h-12 rounded-full bg-slate-800 text-cyan-400 border border-cyan-500/50 hover:bg-cyan-900 hover:text-white flex items-center justify-center transition shadow-lg">
                <i class="fas fa-sync-alt text-xl" id="refreshIcon"></i>
            </button>
        </div>
    </header>

    <div class="container mx-auto px-4 mt-6 max-w-6xl">
        <div class="relative group">
            <div class="absolute -inset-0.5 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-lg blur opacity-30 group-hover:opacity-70 transition"></div>
            <select id="staffFilter" onchange="filterData()" class="relative w-full p-4 bg-slate-900 text-white border border-slate-700 rounded-lg text-xl font-semibold focus:outline-none focus:border-cyan-500 cursor-pointer shadow-xl">
                <option value="all">‚ö° ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô (Show All)</option>
            </select>
        </div>
    </div>

    <div id="contentArea" class="container mx-auto px-4 mt-8 max-w-6xl space-y-8"></div>

    <script>
        // ‚ö†Ô∏è ‡πÉ‡∏™‡πà URL Web App ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const API_URL = "https://script.google.com/macros/s/AKfycbzGmp_5CoVDXRugHW8DOFHes4QI9p-Ho5J5th6hjrCd3U-fTFSkW9X84gRN_xo8au3UQg/exec";
        
        let allData = [];

        document.addEventListener('DOMContentLoaded', () => {
            fetchData(false);
            setInterval(() => fetchData(true), 30000); 
        });

        async function fetchData(isBackground) {
            const refreshIcon = document.getElementById('refreshIcon');
            if(!isBackground) refreshIcon.classList.add('spin-slow');
            try {
                const res = await fetch(API_URL + "?t=" + new Date().getTime());
                const json = await res.json();
                if(json.status === 'success') {
                    allData = json.data;
                    const now = new Date();
                    document.getElementById('lastUpdate').innerText = `SYSTEM ONLINE: ${now.getHours()}:${now.getMinutes().toString().padStart(2,'0')}`;
                    setupFilter(allData);
                    renderTimeline(allData);
                }
            } catch(e) { console.error(e); } 
            finally { refreshIcon.classList.remove('spin-slow'); }
        }

        function setupFilter(data) {
            const select = document.getElementById('staffFilter');
            const current = select.value;
            const staffSet = new Set(data.map(d => d.staff));
            while (select.options.length > 1) select.remove(1);
            Array.from(staffSet).sort().forEach(s => {
                const opt = document.createElement('option');
                opt.value = s; opt.text = `üì° ‡∏Ñ‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á: ${s}`; select.add(opt);
            });
            select.value = current;
        }

        function filterData() {
            const who = document.getElementById('staffFilter').value;
            if(who === 'all') renderTimeline(allData);
            else renderTimeline(allData.filter(d => d.staff === who));
        }

        function isJobFinished(timeStr) {
            const now = new Date();
            const [hours, minutes] = timeStr.split(':').map(Number);
            const jobTime = new Date(); jobTime.setHours(hours, minutes, 0, 0);
            return now > new Date(jobTime.getTime() + (60 * 60 * 1000));
        }

        function renderTimeline(data) {
            const container = document.getElementById('contentArea');
            container.innerHTML = '';
            
            const activeData = data.filter(d => !isJobFinished(d.time)); 

            if(activeData.length === 0) {
                container.innerHTML = `
                    <div class="text-center p-12 bg-slate-900/50 rounded-2xl border border-cyan-900/50">
                        <i class="fas fa-rocket text-6xl text-slate-700 mb-4 animate-bounce"></i>
                        <p class="text-slate-400 text-xl font-mono">NO ACTIVE QUEUES</p>
                        <p class="text-slate-600 mt-2">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
                    </div>`;
                return;
            }

            const groups = activeData.reduce((acc, item) => {
                if(!acc[item.time]) acc[item.time] = [];
                acc[item.time].push(item); return acc;
            }, {});

            Object.keys(groups).sort().forEach(time => {
                const items = groups[time];
                
                let html = `
                    <div class="fade-in">
                        <div class="time-header">
                            <i class="far fa-clock animate-pulse"></i> ${time} ‡∏ô.
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch">
                `;

                items.forEach(item => {
                    let themeClass = 'theme-normal';
                    let patientName = item.patient;
                    
                    // Logic ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
                    const bg = (item.bgColor || "").toLowerCase();
                    const isSheetColor = (bg === '#00ff00' || bg === '#lime' || bg === '#ff00ff' || bg === '#magenta' || bg === '#ffff00' || bg === '#yellow');

                    if (bg === '#00ff00' || bg === '#lime') themeClass = 'theme-sheet-green';
                    else if (bg === '#ff00ff' || bg === '#magenta' || bg === '#ea4335') themeClass = 'theme-sheet-pink';
                    else if (bg === '#ffff00' || bg === '#yellow') themeClass = 'theme-sheet-yellow';

                    // Logic ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ
                    let statusIcon = '';
                    if (item.status === 'available') {
                        if(themeClass === 'theme-normal') themeClass = 'theme-free'; 
                        patientName = `<span class="text-emerald-300">‡∏ß‡πà‡∏≤‡∏á</span>`;
                        statusIcon = `<i class="fas fa-check-circle text-emerald-400 text-2xl"></i>`;
                    
                    } else if (item.status === 'cancelled') {
                        themeClass = 'theme-cancel';
                        patientName = `<span class="line-through opacity-60">${item.patient}</span>`;
                        statusIcon = `<i class="fas fa-times-circle text-slate-500 text-2xl"></i>`;
                    } else {
                        // Busy
                        statusIcon = `<i class="fas fa-user text-cyan-200 opacity-50 text-xl"></i>`;
                        if(isSheetColor) statusIcon = `<i class="fas fa-user text-black opacity-30 text-xl"></i>`;
                    }

                    // --- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (‡πÅ‡∏¢‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ---
                    let contentHtml = '';
                    
                    if (item.status !== 'available' && item.status !== 'cancelled') {
                        let txtTreatment = item.treatment || '&nbsp;';
                        let txtRemarks = item.remarks || '';

                        // 1. ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ö‡∏ô: Treatment (‡πÅ‡∏ñ‡∏ß 3)
                        let badgeHtml = txtTreatment;
                        if (txtTreatment.includes('‡∏à‡∏≠‡∏á')) {
                            badgeHtml = badgeHtml.replace('‡∏à‡∏≠‡∏á', '').trim();
                            badgeHtml = `<span class="badge-booking">‡∏à‡∏≠‡∏á</span>` + badgeHtml;
                        }
                        
                        // 2. ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á: Remarks (‡πÅ‡∏ñ‡∏ß 4)
                        let remarksHtml = '';
                        if (txtRemarks !== '') {
                            if (item.isRemarkStrike) {
                                // ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (‡∏ï‡∏±‡∏ß‡πÅ‡∏î‡∏á‡∏Ç‡∏µ‡∏î‡∏Ü‡πà‡∏≤)
                                remarksHtml = `<div class="detail-row mt-2">
                                    <span class="strike-text"><i class="fas fa-user-slash mr-1"></i>${txtRemarks}</span>
                                </div>`;
                            } else {
                                // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ï‡∏±‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥)
                                remarksHtml = `<div class="detail-row mt-2 opacity-80 text-sm font-semibold">
                                    <i class="fas fa-comment-dots mr-1"></i>${txtRemarks}
                                </div>`;
                            }
                        }

                        contentHtml = `
                            <div class="mt-2">
                                <div class="badge-treatment text-lg">${badgeHtml}</div>
                                ${remarksHtml}
                            </div>
                        `;
                    } else if (item.status === 'available') {
                        contentHtml = `<div class="mt-2 opacity-70 text-lg">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</div>`;
                    } else if (item.status === 'cancelled') {
                        contentHtml = `<div class="mt-2 font-bold opacity-70">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ô‡∏±‡∏î</div>`;
                    }

                    // ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏ó‡∏£
                    const telBtn = (item.tel && item.status !== 'available' && item.status !== 'cancelled') 
                        ? `<a href="tel:${item.tel}" class="w-10 h-10 rounded-full bg-white/20 hover:bg-white/40 flex items-center justify-center transition shadow-lg border border-white/30 text-current"><i class="fas fa-phone text-lg"></i></a>` 
                        : '';

                    // ‡πÄ‡∏•‡∏Ç‡∏´‡πâ‡∏≠‡∏á
                    const roomBadge = item.room 
                        ? `<div class="absolute bottom-3 right-3"><span class="room-tag">${item.room}</span></div>` 
                        : '';

                    html += `
                        <div class="h-full">
                            <div class="queue-card ${themeClass}">
                                
                                <div class="flex justify-between items-start border-b border-white/10 pb-2 mb-2">
                                    <div class="staff-name flex-1 pr-2">
                                        <i class="fas fa-user-astronaut mr-2 opacity-50 text-sm"></i>${item.staff}
                                    </div>
                                    ${telBtn}
                                </div>
                                
                                <div class="flex-grow flex flex-col relative pb-8"> <div class="patient-name-container justify-between">
                                        <div class="patient-text w-full">${patientName}</div>
                                        <div class="pl-2">${statusIcon}</div>
                                    </div>
                                    
                                    ${contentHtml}
                                    
                                    ${roomBadge}
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += `</div></div>`;
                container.innerHTML += html;
            });
        }
    </script>
</body>
</html>
